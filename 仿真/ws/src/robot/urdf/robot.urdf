<?xml version="1.0" encoding="utf-8"?>
<!-- This URDF was automatically created by SolidWorks to URDF Exporter! Originally created by Stephen Brawner (brawner@gmail.com) 
     Commit Version: 1.6.0-4-g7f85cfe  Build Version: 1.6.7995.38578
     For more information, please see http://wiki.ros.org/sw_urdf_exporter -->
<robot
  name="robot">
  <link
    name="base_link">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="10" />
      <inertia
        ixx="0.1"
        ixy="0"
        ixz="0"
        iyy="0.1"
        iyz="0"
        izz="0.1" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/base_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>
  <link
    name="wheel_link1">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="2" />
      <inertia
        ixx="0.01"
        ixy="0"
        ixz="0"
        iyy="0.01"
        iyz="0"
        izz="0.01" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link1.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link1.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_joint1"
    type="continuous">
    <origin
      xyz="0.15595 -0.26408 -0.1411"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_link1" />
    <axis
      xyz="0 1 0" />
  </joint>
  <link
    name="wheel_link2">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="2" />
      <inertia
        ixx="0.01"
        ixy="0"
        ixz="0"
        iyy="0.01"
        iyz="0"
        izz="0.01" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link2.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link2.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_joint2"
    type="continuous">
    <origin
      xyz="-0.19822 -0.2881 -0.1411"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_link2" />
    <axis
      xyz="0 1 0" />
  </joint>
  <link
    name="wheel_link3">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="2" />
      <inertia
        ixx="0.01"
        ixy="0"
        ixz="0"
        iyy="0.01"
        iyz="0"
        izz="0.01" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link3.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link3.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_joint3"
    type="continuous">
    <origin
      xyz="-0.21996 0.26147 -0.1411"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_link3" />
    <axis
      xyz="0 1 0" />
  </joint>
  <link
    name="wheel_link4">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="2" />
      <inertia
        ixx="0.01"
        ixy="0"
        ixz="0"
        iyy="0.01"
        iyz="0"
        izz="0.01" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link4.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/wheel_link4.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_joint4"
    type="continuous">
    <origin
      xyz="0.13421 0.28549 -0.1411"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_link4" />
    <axis
      xyz="0 1 0" />
  </joint>
  <link
    name="lidar_link">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="0.1" />
      <inertia
        ixx="0"
        ixy="0"
        ixz="0"
        iyy="0"
        iyz="0"
        izz="0" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/lidar_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0 0 0 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robot/meshes/lidar_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="lidar_joint"
    type="fixed">
    <origin
      xyz="-0.046164 -0.20002 0.16926"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="lidar_link" />
    <axis
      xyz="0 0 0" />
  </joint>
  <gazebo reference="base_link">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="wheel_link1">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="wheel_link2">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="wheel_link3">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="wheel_link4">
    <material>Gazebo/Black</material>
  </gazebo>

  <!-- 控制器 -->
 <!-- 差分驱动控制器插件 -->
  <gazebo>
    <plugin name="differential_drive_controller" filename="libgazebo_ros_diff_drive.so">
      <!-- 发布频率 -->
      <updateRate>10</updateRate>
      
      <!-- 机器人命名空间 -->
      <robotNamespace>/</robotNamespace>
      
      <!-- 左右轮关节名称（根据你的URDF修改） -->
      <leftJoint>wheel_joint4</leftJoint>
      <rightJoint>wheel_joint1</rightJoint>
      
      <!-- 轮子间距（两个轮子中心之间的距离，单位：米） -->
      <wheelSeparation>0.55</wheelSeparation>  <!-- 根据你的机器人调整 -->
      
      <!-- 轮子直径（单位：米） -->
      <wheelDiameter>0.075</wheelDiameter>      <!-- 根据你的机器人调整 -->
      
      <!-- 轮子加速度限制 -->
      <wheelAcceleration>5</wheelAcceleration>

      <!-- 关键：设置轮子扭矩（减小这个值避免过度驱动） -->
      <wheelTorque>5.0</wheelTorque> <!-- 从默认5.0减小 -->
            
      <commandTopic>/cmd_vel</commandTopic>

      <!-- 添加缺失的参数避免警告 -->
      <odometryTopic>/odom</odometryTopic>
      <odometryFrame>odom</odometryFrame>
      <robotBaseFrame>base_link</robotBaseFrame>
      <publishWheelTF>false</publishWheelTF>
      <publishOdomTF>true</publishOdomTF>
      <publishWheelJointState>false</publishWheelJointState>
    </plugin>
  </gazebo>
  <gazebo>
    <plugin name="differential_drive_controller" filename="libgazebo_ros_diff_drive.so">
      <!-- 发布频率 -->
      <updateRate>10</updateRate>
      
      <!-- 机器人命名空间 -->
      <robotNamespace></robotNamespace>
      
      <!-- 左右轮关节名称（根据你的URDF修改） -->
      <leftJoint>wheel_joint3</leftJoint>
      <rightJoint>wheel_joint2</rightJoint>
      
      <!-- 轮子间距（两个轮子中心之间的距离，单位：米） -->
      <wheelSeparation>0.55</wheelSeparation>  <!-- 根据你的机器人调整 -->
      
      <!-- 轮子直径（单位：米） -->
      <wheelDiameter>0.075</wheelDiameter>      <!-- 根据你的机器人调整 -->
      
      <!-- 轮子加速度限制 -->
      <wheelAcceleration>5</wheelAcceleration>

      <!-- 关键：设置轮子扭矩（减小这个值避免过度驱动） -->
      <wheelTorque>5.0</wheelTorque> <!-- 从默认5.0减小 -->
            
      <commandTopic>/cmd_vel</commandTopic>
      
      <!-- 添加缺失的参数避免警告 -->
      <odometryTopic>/odom2</odometryTopic>
      <odometryFrame>odom2</odometryFrame>
      <robotBaseFrame>base_link</robotBaseFrame>
      <publishWheelTF>false</publishWheelTF>
      <publishOdomTF>false</publishOdomTF>
      <publishWheelJointState>false</publishWheelJointState>
    </plugin>
  </gazebo>
  <gazebo reference="lidar_link">

      <!-- 发布lidar数据 -->
      <sensor type="ray" name="lidar_link">
        <pose>0 0 0 0 3.1415 0</pose>
        <visualize>true</visualize>  <!-- 从visualize参数展开 -->
        <update_rate>10</update_rate>  <!-- 从update_rate参数展开 -->
        
        <!-- liblivox_laser_simulation插件配置 -->
        <plugin name="gazebo_ros_laser_controller" filename="liblivox_laser_simulation.so">
          <publish_pointcloud_type>1</publish_pointcloud_type>
          <ray>
            <scan>
              <!-- 水平扫描配置 -->
              <horizontal>
                <samples>100</samples>
                <resolution>1</resolution>
                <min_angle>0</min_angle>  <!-- 0弧度 -->
                <max_angle>6.28318</max_angle>  <!-- 2 * 3.14159 = 6.28318弧度 (360度) -->
              </horizontal>
              
              <!-- 垂直扫描配置 -->
              <vertical>
                <samples>360</samples>
                <resolution>1</resolution>
                <min_angle>-0.1260</min_angle>  <!-- -7.22度转弧度: -7.22/180*3.14159 = -0.1260 -->
                <max_angle>0.9636</max_angle>   <!-- 55.22度转弧度: 55.22/180*3.14159 = 0.9636 -->
              </vertical>
            </scan>
            
            <!-- 距离范围配置 -->
            <range>
              <min>0.1</min>        <!-- laser_min_range -->
              <max>200.0</max>      <!-- laser_max_range -->
              <resolution>0.002</resolution>  <!-- 从resolution参数展开 -->
            </range>
            
            <!-- 噪声配置 -->
            <noise>
              <type>gaussian</type>
              <mean>0.0</mean>      <!-- noise_mean -->
              <stddev>0.01</stddev> <!-- noise_stddev -->
            </noise>
          </ray>
          
          <!-- 插件参数 -->
          <visualize>false</visualize>        <!-- 从visualize参数展开 -->
          <samples>24000</samples>           <!-- samples属性 -->
          <downsample>1</downsample>         <!-- downsample属性 -->
          <csv_file_name>package://livox_laser_simulation/scan_mode/mid360.csv</csv_file_name>
          <ros_topic>/livox/lidar</ros_topic>        <!-- ros_topic属性 -->
          <frame_name>lidar_link</frame_name>
        </plugin>
      </sensor>
  </gazebo>

      <!-- 机器人模型中添加IMU插件 -->
  <gazebo reference="lidar_link">
    <!-- <gravity>true</gravity> -->
      <!-- 发布imu数据 -->
    <sensor name="imu" type="imu">
      <pose>0 0 0 0 0 0</pose>
      <always_on>true</always_on>
      <update_rate>10</update_rate>
      <plugin name="imu_plugin" filename="libgazebo_ros_imu_sensor.so">
          <robotNamespace></robotNamespace>
          <topicName>/imu/data</topicName>
          <frameName>lidar_link</frameName>
      </plugin>
    </sensor>
  </gazebo>
  <!-- 雷达 -->
  <!-- <gazebo reference="lidar_link">
    <sensor type="ray" name="rplidar">
      <pose>0 0 0 0 3.1415 0</pose>
      <visualize>false</visualize>
      <update_rate>5</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>360</samples>
            <resolution>1</resolution>
            <min_angle>-3</min_angle>
            <max_angle>3</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.10</min>
          <max>30.0</max>
          <resolution>0.01</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
      <plugin name="gazebo_rplidar" filename="libgazebo_ros_laser.so">
        <topicName>/scan1</topicName>
        <frameName>lidar_link</frameName>
      </plugin>
    </sensor>
  </gazebo> -->
</robot>